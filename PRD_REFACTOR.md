# 星趣App重构需求文档 (PRD_REFACTOR.md)

## 1. 重构目标

### 1.1 核心目标
基于原型文件重构Flutter应用，实现高保真的UI还原和完整的功能体验。

### 1.2 约束条件
- **保持不变**: 启动页(splash_page.dart)和登录页(login_page.dart)
- **重构范围**: 其他所有页面和功能模块
- **技术栈**: Flutter + Supabase + Provider

## 2. 重构模块清单

### 2.1 需要重构的核心模块
1. **首页模块** (home_page.dart)
   - 精选推荐页面
   - AI角色卡片展示
   - 搜索和导航功能

2. **综合页模块** (新增)
   - 订阅管理页面
   - 推荐算法页面  
   - 挑战任务页面
   - 记忆管理页面
   - 双语学习页面
   - 智能体管理页面

3. **FM音频模块** (新增)
   - 音频播放器
   - 音频列表和分类
   - 播放控制和进度

4. **专属助理模块** (新增)
   - AI助手"星若"对话界面
   - 多模态交互功能
   - 智能功能扩展

5. **发现页模块** (新增)
   - 内容探索和推荐
   - 钻石榜和热门内容
   - 星野市集入口

6. **创作中心模块** (creation_center_page.dart - 重构)
   - 角色创作工具
   - 内容创作功能
   - 作品管理和发布

7. **底部导航系统** (重构)
   - 五个Tab页导航
   - 状态管理和页面切换

### 2.2 需要新增的数据模型
1. **AI角色模型** (AICharacter)
2. **音频内容模型** (AudioContent)  
3. **用户订阅模型** (UserSubscription)
4. **挑战任务模型** (Challenge)
5. **创作作品模型** (CreativeWork)

### 2.3 需要重构的服务层
1. **AI服务** (ai_service.dart)
2. **音频服务** (audio_service.dart)
3. **推荐服务** (recommendation_service.dart)
4. **创作服务** (creation_service.dart)

## 3. UI/UX设计要求

### 3.1 设计原则
- 严格按照prototype文件夹中的HTML原型还原
- 保持深色主题和品牌色彩(#F5DFAF)
- 实现流畅的动画和交互效果

### 3.2 关键页面对应关系
- `prototype/index.html` → 首页精选模块
- `prototype/home-comprehensive.html` → 综合页模块  
- `prototype/home-fm.html` → FM音频模块
- `prototype/home-assistant.html` → 专属助理模块
- `prototype/discovery.html` → 发现页模块
- `prototype/creation.html` → 创作中心模块

## 4. 技术实现要求

### 4.1 状态管理
- 使用Provider进行全局状态管理
- 实现页面间数据共享和状态同步

### 4.2 数据库集成
- 更新Supabase数据库schema
- 实现实时数据同步
- 配置Row Level Security (RLS)

### 4.3 性能优化
- 实现懒加载和分页
- 优化图片缓存和加载
- 减少不必要的重建

## 5. 验收标准

### 5.1 功能完整性
- [ ] 所有核心功能模块正常运行
- [ ] 页面导航和状态切换正常
- [ ] 数据加载和保存功能正常

### 5.2 UI还原度
- [ ] 与原型文件90%以上相似度
- [ ] 动画和交互效果完整
- [ ] 响应式设计适配不同屏幕

### 5.3 代码质量
- [ ] 代码结构清晰，遵循最佳实践
- [ ] 注释充分，便于维护
- [ ] 性能优化到位

## 6. 项目时间线

### Phase 1: 设计阶段 (当前)
- 分析原型文件和设计规范
- 制定技术架构和实现方案

### Phase 2: 开发阶段 
- 重构核心页面和功能模块
- 集成数据库和API服务

### Phase 3: 测试阶段
- 功能测试和UI测试
- 性能优化和bug修复

---

**产品经理确认**: 需求分析完成，请UI/UX设计师开始设计阶段工作。

请输入 **/设计** 继续下一步，或 **/修改** 对需求进行调整。