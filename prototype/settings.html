<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>星趣 - 设置</title>
    <link rel="stylesheet" href="common-styles.css">
    <style>
        /* iPhone 15 Pro外观样式 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
            background: #000000;
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            overflow: hidden;
        }

        /* iPhone 15 Pro 机身容器 */
        .iphone-container {
            position: relative;
            width: 393px;
            height: 852px;
            margin: 40px auto;
            background: #1f1f1f;
            border-radius: 55px;
            padding: 8px;
            box-shadow: 
                0 0 0 2px #333333,
                0 8px 30px rgba(0, 0, 0, 0.8),
                inset 0 0 0 1px rgba(255, 255, 255, 0.1);
        }

        /* iPhone 15 Pro 屏幕 */
        .iphone-screen {
            width: 100%;
            height: 100%;
            background: #000000;
            border-radius: 47px;
            overflow: hidden;
            position: relative;
        }

        /* Dynamic Island */
        .dynamic-island {
            position: absolute;
            top: 12px;
            left: 50%;
            transform: translateX(-50%);
            width: 126px;
            height: 37px;
            background: #000000;
            border-radius: 18px;
            z-index: 1000;
            border: 0.5px solid #333;
        }

        /* 物理按键 */
        .power-button {
            position: absolute;
            right: -3px;
            top: 200px;
            width: 4px;
            height: 80px;
            background: #333333;
            border-radius: 2px 0 0 2px;
        }

        .volume-up {
            position: absolute;
            left: -3px;
            top: 160px;
            width: 4px;
            height: 50px;
            background: #333333;
            border-radius: 0 2px 2px 0;
        }

        .volume-down {
            position: absolute;
            left: -3px;
            top: 220px;
            width: 4px;
            height: 50px;
            background: #333333;
            border-radius: 0 2px 2px 0;
        }

        .action-button {
            position: absolute;
            left: -3px;
            top: 100px;
            width: 4px;
            height: 40px;
            background: #333333;
            border-radius: 0 2px 2px 0;
        }

        /* iOS状态栏 */
        .status-bar {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 54px;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px 0 24px;
            font-size: 17px;
            font-weight: 600;
            color: #FFFFFF;
            z-index: 999;
        }

        .status-left {
            font-size: 17px;
            margin-top: 8px;
        }

        .status-right {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 17px;
            margin-top: 8px;
        }

        .battery {
            width: 27px;
            height: 13px;
            border: 1px solid #FFFFFF;
            border-radius: 3px;
            position: relative;
            margin-left: 2px;
        }

        .battery::after {
            content: '';
            position: absolute;
            right: -4px;
            top: 4px;
            width: 2px;
            height: 5px;
            background: #FFFFFF;
            border-radius: 0 1px 1px 0;
        }

        .battery-fill {
            background: #34C759;
            height: 100%;
            width: 80%;
            border-radius: 2px;
        }

        /* 应用内容区域 */
        .app-container {
            position: absolute;
            top: 54px;
            left: 0;
            right: 0;
            bottom: 0;
            background: #000000;
            display: flex;
            flex-direction: column;
        }

        /* 顶部导航栏 */
        .nav-header {
            background: rgba(0, 0, 0, 0.95);
            padding: 16px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #1C1C1E;
            backdrop-filter: blur(20px);
            position: relative;
            z-index: 100;
        }

        .nav-title {
            color: #FFFFFF;
            font-size: 20px;
            font-weight: 700;
            text-align: center;
            flex: 1;
        }

        .nav-action {
            width: 32px;
            height: 32px;
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #FFC542;
            font-size: 16px;
            text-decoration: none;
        }

        .nav-action:hover {
            background: rgba(255, 197, 66, 0.2);
            transform: scale(1.1);
        }

        /* 设置内容容器 */
        .settings-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            background: #000000;
        }

        .settings-content {
            flex: 1;
            overflow-y: auto;
            padding: 0;
        }

        /* 搜索栏 */
        .search-container {
            padding: 16px 20px;
            background: rgba(0, 0, 0, 0.95);
            border-bottom: 1px solid #1C1C1E;
        }

        .search-box {
            background: #1C1C1E;
            border-radius: 12px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s ease;
        }

        .search-box:focus-within {
            background: #2A2A2A;
            border: 1px solid #FFC542;
        }

        .search-icon {
            color: #8E8E93;
            font-size: 16px;
        }

        .search-input {
            flex: 1;
            background: transparent;
            border: none;
            color: #FFFFFF;
            font-size: 16px;
            outline: none;
        }

        .search-input::placeholder {
            color: #8E8E93;
        }

        /* 用户信息卡片 */
        .user-card {
            margin: 20px;
            padding: 20px;
            background: #1C1C1E;
            border-radius: 16px;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .user-avatar {
            width: 60px;
            height: 60px;
            border-radius: 30px;
            background: linear-gradient(135deg, #FFC542, #F5DFAF);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #000000;
            flex-shrink: 0;
        }

        .user-info {
            flex: 1;
        }

        .user-name {
            color: #FFFFFF;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .user-status {
            color: #FFC542;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .user-id {
            color: #8E8E93;
            font-size: 12px;
        }

        /* 设置组 */
        .settings-section {
            padding: 0 20px 20px 20px;
        }

        .section-title {
            color: #8E8E93;
            font-size: 13px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
            padding-left: 4px;
        }

        .settings-group {
            background: #1C1C1E;
            border-radius: 12px;
            overflow: hidden;
        }

        .setting-item {
            display: flex;
            align-items: center;
            padding: 16px;
            border-bottom: 1px solid #2A2A2A;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .setting-item:active {
            background: rgba(255, 255, 255, 0.1);
        }

        .setting-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .setting-icon.default {
            background: rgba(255, 197, 66, 0.2);
            color: #FFC542;
        }

        .setting-icon.blue {
            background: rgba(0, 122, 255, 0.2);
            color: #007AFF;
        }

        .setting-icon.green {
            background: rgba(52, 199, 89, 0.2);
            color: #34C759;
        }

        .setting-icon.purple {
            background: rgba(175, 82, 222, 0.2);
            color: #AF52DE;
        }

        .setting-icon.red {
            background: rgba(255, 69, 58, 0.2);
            color: #FF453A;
        }

        .setting-icon.orange {
            background: rgba(255, 149, 0, 0.2);
            color: #FF9500;
        }

        .setting-content {
            flex: 1;
            min-width: 0;
        }

        .setting-title {
            color: #FFFFFF;
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 2px;
        }

        .setting-description {
            color: #8E8E93;
            font-size: 14px;
            line-height: 1.3;
        }

        .setting-value {
            color: #8E8E93;
            font-size: 16px;
            margin-left: 8px;
        }

        .setting-arrow {
            color: #666666;
            font-size: 16px;
            margin-left: 8px;
        }

        .setting-badge {
            background: #FF453A;
            color: #FFFFFF;
            font-size: 12px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 8px;
            margin-left: 8px;
            min-width: 16px;
            text-align: center;
        }

        .setting-toggle {
            width: 50px;
            height: 30px;
            background: #333333;
            border-radius: 15px;
            position: relative;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .setting-toggle.active {
            background: #34C759;
        }

        .setting-toggle::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 26px;
            height: 26px;
            background: #FFFFFF;
            border-radius: 13px;
            transition: transform 0.3s ease;
        }

        .setting-toggle.active::after {
            transform: translateX(20px);
        }

        /* 危险操作 */
        .danger-setting .setting-title {
            color: #FF453A;
        }

        .danger-setting .setting-icon {
            background: rgba(255, 69, 58, 0.2);
            color: #FF453A;
        }

        /* 存储使用情况 */
        .storage-item {
            padding: 16px;
            border-bottom: 1px solid #2A2A2A;
        }

        .storage-item:last-child {
            border-bottom: none;
        }

        .storage-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 8px;
        }

        .storage-name {
            color: #FFFFFF;
            font-size: 16px;
            font-weight: 500;
        }

        .storage-size {
            color: #8E8E93;
            font-size: 14px;
        }

        .storage-bar {
            width: 100%;
            height: 6px;
            background: #333333;
            border-radius: 3px;
            overflow: hidden;
        }

        .storage-fill {
            height: 100%;
            background: linear-gradient(90deg, #34C759, #FFC542);
            border-radius: 3px;
            transition: width 0.5s ease;
        }

        /* 版本信息 */
        .version-info {
            margin: 20px;
            padding: 20px;
            background: rgba(255, 197, 66, 0.1);
            border: 1px solid rgba(255, 197, 66, 0.2);
            border-radius: 16px;
            text-align: center;
        }

        .app-icon {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px auto;
            overflow: hidden;
        }

        .app-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 20px;
        }

        .app-name {
            color: #FFFFFF;
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .app-version {
            color: #8E8E93;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .app-build {
            color: #8E8E93;
            font-size: 12px;
        }

        /* 滚动条样式 */
        .settings-content::-webkit-scrollbar {
            width: 4px;
        }

        .settings-content::-webkit-scrollbar-track {
            background: transparent;
        }

        .settings-content::-webkit-scrollbar-thumb {
            background: rgba(255, 197, 66, 0.3);
            border-radius: 2px;
        }

        /* 响应式适配 */
        @media (max-width: 414px) {
            .iphone-container {
                margin: 20px auto;
            }
            
            .user-card {
                margin: 16px;
                padding: 16px;
            }
            
            .search-container {
                padding: 12px 16px;
            }
            
            .settings-section {
                padding: 0 16px 16px 16px;
            }
            
            .version-info {
                margin: 16px;
                padding: 16px;
            }
        }

        /* 动画效果 */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .setting-item {
            animation: fadeInUp 0.3s ease;
        }

        .setting-item:nth-child(1) { animation-delay: 0.1s; }
        .setting-item:nth-child(2) { animation-delay: 0.2s; }
        .setting-item:nth-child(3) { animation-delay: 0.3s; }
        .setting-item:nth-child(4) { animation-delay: 0.4s; }
        .setting-item:nth-child(5) { animation-delay: 0.5s; }

        /* 模态框样式 */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .modal-content {
            background: #1C1C1E;
            border-radius: 20px;
            padding: 24px;
            max-width: 320px;
            width: 90%;
            text-align: center;
        }

        .modal-title {
            color: #FFFFFF;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .modal-message {
            color: #8E8E93;
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 24px;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
        }

        .modal-btn {
            flex: 1;
            padding: 12px;
            border-radius: 12px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-btn-cancel {
            background: rgba(255, 255, 255, 0.1);
            color: #FFFFFF;
        }

        .modal-btn-confirm {
            background: #FF453A;
            color: #FFFFFF;
        }

        .modal-btn:hover {
            transform: translateY(-1px);
        }

        /* 选择器样式 */
        .picker-modal .modal-content {
            max-width: 280px;
        }

        .picker-options {
            max-height: 200px;
            overflow-y: auto;
            margin: 16px 0 24px 0;
        }

        .picker-option {
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            margin: 4px 0;
            border-radius: 8px;
            color: #FFFFFF;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .picker-option:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .picker-option.selected {
            background: rgba(255, 197, 66, 0.2);
            color: #FFC542;
        }
    </style>
</head>
<body>
    <!-- iPhone 15 Pro 容器 -->
    <div class="iphone-container">
        <!-- Dynamic Island -->
        <div class="dynamic-island"></div>
        
        <!-- 物理按键 -->
        <div class="power-button"></div>
        <div class="volume-up"></div>
        <div class="volume-down"></div>
        <div class="action-button"></div>
        
        <!-- iPhone 屏幕 -->
        <div class="iphone-screen">
            <!-- iOS状态栏 -->
            <div class="status-bar">
                <div class="status-left">9:41</div>
                <div class="status-right">
                    <span style="font-size: 16px;">•••</span>
                    <span style="font-size: 16px;">📶</span>
                    <span style="font-size: 16px;">📶</span>
                    <div class="battery">
                        <div class="battery-fill"></div>
                    </div>
                </div>
            </div>

            <!-- 应用内容区域 -->
            <div class="app-container">
                <!-- 顶部导航栏 -->
                <div class="nav-header">
                    <div class="nav-action" onclick="goBack()" title="返回">←</div>
                    <h1 class="nav-title">设置</h1>
                    <div class="nav-action"></div>
                </div>

                <!-- 设置内容容器 -->
                <div class="settings-container">
                    <div class="settings-content">
                        <!-- 搜索栏 -->
                        <div class="search-container">
                            <div class="search-box" onclick="openSearchPage()" style="cursor: pointer;">
                                <span class="search-icon">🔍</span>
                                <div class="search-placeholder" style="flex: 1; color: #9B9B9B; padding: 10px 16px;">搜索设置...</div>
                            </div>
                        </div>

                        <!-- 用户信息卡片 -->
                        <div class="user-card" onclick="openProfile()">
                            <div class="user-avatar">👤</div>
                            <div class="user-info">
                                <div class="user-name">星空梦想家</div>
                                <div class="user-status">✨ 创作新星</div>
                                <div class="user-id">ID: 20241215001</div>
                            </div>
                            <div class="setting-arrow">›</div>
                        </div>

                        <!-- 账户设置 -->
                        <div class="settings-section">
                            <div class="section-title">账户设置</div>
                            <div class="settings-group">
                                <div class="setting-item" onclick="openPersonalInfo()">
                                    <div class="setting-icon default">👤</div>
                                    <div class="setting-content">
                                        <div class="setting-title">个人信息</div>
                                        <div class="setting-description">编辑头像、昵称和个人简介</div>
                                    </div>
                                    <div class="setting-arrow">›</div>
                                </div>

                                <div class="setting-item" onclick="openSecurity()">
                                    <div class="setting-icon blue">🔒</div>
                                    <div class="setting-content">
                                        <div class="setting-title">安全与隐私</div>
                                        <div class="setting-description">密码、二次验证和隐私设置</div>
                                    </div>
                                    <div class="setting-arrow">›</div>
                                </div>

                                <div class="setting-item" onclick="openMembership()">
                                    <div class="setting-icon orange">⭐</div>
                                    <div class="setting-content">
                                        <div class="setting-title">会员与订阅</div>
                                        <div class="setting-description">管理VIP会员和订阅服务</div>
                                    </div>
                                    <div class="setting-badge">VIP</div>
                                    <div class="setting-arrow">›</div>
                                </div>
                            </div>
                        </div>

                        <!-- 应用偏好 -->
                        <div class="settings-section">
                            <div class="section-title">应用偏好</div>
                            <div class="settings-group">
                                <div class="setting-item">
                                    <div class="setting-icon green">🌙</div>
                                    <div class="setting-content">
                                        <div class="setting-title">暗黑模式</div>
                                        <div class="setting-description">自动跟随系统设置</div>
                                    </div>
                                    <div class="setting-toggle active" onclick="toggleDarkMode(this)"></div>
                                </div>

                                <div class="setting-item" onclick="openLanguage()">
                                    <div class="setting-icon blue">🌐</div>
                                    <div class="setting-content">
                                        <div class="setting-title">语言设置</div>
                                        <div class="setting-description">选择应用界面语言</div>
                                    </div>
                                    <div class="setting-value">简体中文</div>
                                    <div class="setting-arrow">›</div>
                                </div>

                                <div class="setting-item" onclick="openFontSize()">
                                    <div class="setting-icon purple">🔤</div>
                                    <div class="setting-content">
                                        <div class="setting-title">字体大小</div>
                                        <div class="setting-description">调整文字显示大小</div>
                                    </div>
                                    <div class="setting-value">标准</div>
                                    <div class="setting-arrow">›</div>
                                </div>

                                <div class="setting-item">
                                    <div class="setting-icon green">🔔</div>
                                    <div class="setting-content">
                                        <div class="setting-title">推送通知</div>
                                        <div class="setting-description">新消息和更新提醒</div>
                                    </div>
                                    <div class="setting-toggle active" onclick="toggleNotifications(this)"></div>
                                </div>

                                <div class="setting-item">
                                    <div class="setting-icon orange">🎵</div>
                                    <div class="setting-content">
                                        <div class="setting-title">声音效果</div>
                                        <div class="setting-description">点击音效和提示音</div>
                                    </div>
                                    <div class="setting-toggle" onclick="toggleSounds(this)"></div>
                                </div>

                                <div class="setting-item">
                                    <div class="setting-icon purple">📳</div>
                                    <div class="setting-content">
                                        <div class="setting-title">触觉反馈</div>
                                        <div class="setting-description">点击时的震动反馈</div>
                                    </div>
                                    <div class="setting-toggle active" onclick="toggleHaptics(this)"></div>
                                </div>
                            </div>
                        </div>

                        <!-- 创作设置 -->
                        <div class="settings-section">
                            <div class="section-title">创作设置</div>
                            <div class="settings-group">
                                <div class="setting-item">
                                    <div class="setting-icon default">🤖</div>
                                    <div class="setting-content">
                                        <div class="setting-title">AI写作助手</div>
                                        <div class="setting-description">智能创作建议和语法检查</div>
                                    </div>
                                    <div class="setting-toggle active" onclick="toggleAIAssistant(this)"></div>
                                </div>

                                <div class="setting-item">
                                    <div class="setting-icon blue">💾</div>
                                    <div class="setting-content">
                                        <div class="setting-title">自动保存</div>
                                        <div class="setting-description">自动保存草稿，防止内容丢失</div>
                                    </div>
                                    <div class="setting-toggle active" onclick="toggleAutoSave(this)"></div>
                                </div>

                                <div class="setting-item" onclick="openWordCount()">
                                    <div class="setting-icon green">📊</div>
                                    <div class="setting-content">
                                        <div class="setting-title">字数统计</div>
                                        <div class="setting-description">显示创作字数和阅读时间</div>
                                    </div>
                                    <div class="setting-toggle active" onclick="toggleWordCount(this)"></div>
                                </div>
                            </div>
                        </div>

                        <!-- 存储与缓存 -->
                        <div class="settings-section">
                            <div class="section-title">存储与缓存</div>
                            <div class="settings-group">
                                <div class="storage-item">
                                    <div class="storage-header">
                                        <div class="storage-name">应用数据</div>
                                        <div class="storage-size">128 MB</div>
                                    </div>
                                    <div class="storage-bar">
                                        <div class="storage-fill" style="width: 25%;"></div>
                                    </div>
                                </div>

                                <div class="storage-item">
                                    <div class="storage-header">
                                        <div class="storage-name">缓存文件</div>
                                        <div class="storage-size">256 MB</div>
                                    </div>
                                    <div class="storage-bar">
                                        <div class="storage-fill" style="width: 50%;"></div>
                                    </div>
                                </div>

                                <div class="storage-item">
                                    <div class="storage-header">
                                        <div class="storage-name">离线内容</div>
                                        <div class="storage-size">89 MB</div>
                                    </div>
                                    <div class="storage-bar">
                                        <div class="storage-fill" style="width: 18%;"></div>
                                    </div>
                                </div>

                                <div class="setting-item" onclick="clearCache()">
                                    <div class="setting-icon orange">🗑️</div>
                                    <div class="setting-content">
                                        <div class="setting-title">清理缓存</div>
                                        <div class="setting-description">清除临时文件和缓存数据</div>
                                    </div>
                                    <div class="setting-arrow">›</div>
                                </div>
                            </div>
                        </div>

                        <!-- 帮助与支持 -->
                        <div class="settings-section">
                            <div class="section-title">帮助与支持</div>
                            <div class="settings-group">
                                <div class="setting-item" onclick="openHelp()">
                                    <div class="setting-icon blue">❓</div>
                                    <div class="setting-content">
                                        <div class="setting-title">帮助中心</div>
                                        <div class="setting-description">常见问题解答和使用指南</div>
                                    </div>
                                    <div class="setting-arrow">›</div>
                                </div>

                                <div class="setting-item" onclick="contactSupport()">
                                    <div class="setting-icon green">💬</div>
                                    <div class="setting-content">
                                        <div class="setting-title">联系客服</div>
                                        <div class="setting-description">在线客服和技术支持</div>
                                    </div>
                                    <div class="setting-arrow">›</div>
                                </div>

                                <div class="setting-item" onclick="sendFeedback()">
                                    <div class="setting-icon purple">📝</div>
                                    <div class="setting-content">
                                        <div class="setting-title">意见反馈</div>
                                        <div class="setting-description">帮助我们改进应用体验</div>
                                    </div>
                                    <div class="setting-arrow">›</div>
                                </div>

                                <div class="setting-item" onclick="rateApp()">
                                    <div class="setting-icon orange">⭐</div>
                                    <div class="setting-content">
                                        <div class="setting-title">为应用评分</div>
                                        <div class="setting-description">在应用商店给我们评分</div>
                                    </div>
                                    <div class="setting-arrow">›</div>
                                </div>
                            </div>
                        </div>

                        <!-- 高级设置 -->
                        <div class="settings-section">
                            <div class="section-title">高级设置</div>
                            <div class="settings-group">
                                <div class="setting-item" onclick="openDeveloper()">
                                    <div class="setting-icon purple">⚙️</div>
                                    <div class="setting-content">
                                        <div class="setting-title">开发者选项</div>
                                        <div class="setting-description">调试模式和实验性功能</div>
                                    </div>
                                    <div class="setting-arrow">›</div>
                                </div>

                                <div class="setting-item" onclick="exportData()">
                                    <div class="setting-icon blue">📤</div>
                                    <div class="setting-content">
                                        <div class="setting-title">导出数据</div>
                                        <div class="setting-description">导出个人数据和创作内容</div>
                                    </div>
                                    <div class="setting-arrow">›</div>
                                </div>

                                <div class="setting-item danger-setting" onclick="resetApp()">
                                    <div class="setting-icon red">🔄</div>
                                    <div class="setting-content">
                                        <div class="setting-title">重置应用</div>
                                        <div class="setting-description">恢复所有设置到默认状态</div>
                                    </div>
                                    <div class="setting-arrow">›</div>
                                </div>

                                <div class="setting-item danger-setting" onclick="deleteAccount()">
                                    <div class="setting-icon red">🗑️</div>
                                    <div class="setting-content">
                                        <div class="setting-title">删除账户</div>
                                        <div class="setting-description">永久删除账户和所有数据</div>
                                    </div>
                                    <div class="setting-arrow">›</div>
                                </div>
                            </div>
                        </div>

                        <!-- 版本信息 -->
                        <div class="version-info">
                            <div class="app-icon">
                                <img src="assets/images/logo.png" alt="星趣Logo">
                            </div>
                            <div class="app-name">星趣 - 发现有趣的故事</div>
                            <div class="app-version">版本 1.0.0 (Build 2024.12.15)</div>
                            <div class="app-build">© 2024 星趣团队. 保留所有权利.</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 确认模态框 -->
    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <div class="modal-title" id="modalTitle">确认操作</div>
            <div class="modal-message" id="modalMessage">您确定要执行此操作吗？</div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-cancel" onclick="closeModal()">取消</button>
                <button class="modal-btn modal-btn-confirm" onclick="confirmAction()" id="confirmBtn">确认</button>
            </div>
        </div>
    </div>

    <!-- 选择器模态框 -->
    <div class="modal picker-modal" id="pickerModal">
        <div class="modal-content">
            <div class="modal-title" id="pickerTitle">选择选项</div>
            <div class="picker-options" id="pickerOptions">
                <!-- 选项将动态添加 -->
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-cancel" onclick="closePicker()">取消</button>
                <button class="modal-btn modal-btn-confirm" onclick="confirmPicker()">确认</button>
            </div>
        </div>
    </div>

    <script>
        /**
         * 设置页面交互逻辑
         * 包含各种设置项的管理、开关切换、模态框操作等功能
         * @description iPhone15pro样式的设置页面
         */

        // DOM元素引用
        const searchInput = document.getElementById('searchInput');
        const confirmModal = document.getElementById('confirmModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalMessage = document.getElementById('modalMessage');
        const confirmBtn = document.getElementById('confirmBtn');
        const pickerModal = document.getElementById('pickerModal');
        const pickerTitle = document.getElementById('pickerTitle');
        const pickerOptions = document.getElementById('pickerOptions');

        // 状态管理
        let currentSearchQuery = '';
        let currentAction = null;
        let currentPickerType = null;
        let selectedOption = null;

        // 设置数据
        const settingsData = {
            darkMode: true,
            notifications: true,
            sounds: false,
            haptics: true,
            aiAssistant: true,
            autoSave: true,
            wordCount: true,
            language: '简体中文',
            fontSize: '标准'
        };

        // 页面初始化
        document.addEventListener('DOMContentLoaded', function() {
            console.log('设置页面已加载 - iPhone15pro样式');
            initEventListeners();
            loadSettings();
        });

        /**
         * 初始化事件监听器
         * @description 绑定所有设置相关事件
         */
        function initEventListeners() {
            // 搜索功能
            searchInput.addEventListener('input', handleSearch);
            searchInput.addEventListener('focus', function() {
                this.parentElement.style.transform = 'scale(1.02)';
            });
            searchInput.addEventListener('blur', function() {
                this.parentElement.style.transform = 'scale(1)';
            });

            // 点击模态框外部关闭
            confirmModal.addEventListener('click', function(e) {
                if (e.target === confirmModal) {
                    closeModal();
                }
            });

            pickerModal.addEventListener('click', function(e) {
                if (e.target === pickerModal) {
                    closePicker();
                }
            });

            // 键盘事件
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeModal();
                    closePicker();
                }
            });
        }

        /**
         * 处理搜索
         * @description 搜索设置项
         */
        function handleSearch() {
            const query = searchInput.value.trim().toLowerCase();
            currentSearchQuery = query;
            
            const settingItems = document.querySelectorAll('.setting-item, .storage-item');
            const sections = document.querySelectorAll('.settings-section');
            
            if (query === '') {
                // 显示所有设置项和分组
                settingItems.forEach(item => {
                    item.style.display = 'flex';
                });
                sections.forEach(section => {
                    section.style.display = 'block';
                });
            } else {
                // 过滤设置项
                sections.forEach(section => {
                    let hasVisibleItems = false;
                    const items = section.querySelectorAll('.setting-item, .storage-item');
                    
                    items.forEach(item => {
                        const title = item.querySelector('.setting-title, .storage-name')?.textContent.toLowerCase();
                        const desc = item.querySelector('.setting-description')?.textContent.toLowerCase();
                        
                        if ((title && title.includes(query)) || (desc && desc.includes(query))) {
                            item.style.display = 'flex';
                            hasVisibleItems = true;
                        } else {
                            item.style.display = 'none';
                        }
                    });
                    
                    section.style.display = hasVisibleItems ? 'block' : 'none';
                });
            }
            
            console.log('搜索设置:', query);
        }

        /**
         * 加载设置
         * @description 初始化加载设置数据
         */
        function loadSettings() {
            console.log('加载设置数据');
            
            // 更新开关状态
            updateToggleStates();
        }

        /**
         * 更新开关状态
         * @description 根据设置数据更新所有开关的状态
         */
        function updateToggleStates() {
            const toggles = document.querySelectorAll('.setting-toggle');
            
            toggles.forEach((toggle, index) => {
                const keys = ['darkMode', 'notifications', 'sounds', 'haptics', 'aiAssistant', 'autoSave', 'wordCount'];
                const key = keys[index];
                
                if (key && settingsData[key]) {
                    toggle.classList.add('active');
                } else if (key) {
                    toggle.classList.remove('active');
                }
            });
        }

        /**
         * 打开搜索页面
         * @description 跳转到搜索页面
         */
        function openSearchPage() {
            console.log('跳转到搜索页面');
            window.location.href = 'search.html';
        }

        /**
         * 返回上一页
         * @description 返回到个人中心或主页
         */
        function goBack() {
            console.log('返回上一页');
            showToast('正在返回...');
            setTimeout(() => {
                window.location.href = 'profile.html';
            }, 500);
        }

        /**
         * 打开个人资料
         * @description 跳转到个人资料页面
         */
        function openProfile() {
            console.log('打开个人资料');
            showToast('正在打开个人资料...');
            setTimeout(() => {
                window.location.href = 'profile.html';
            }, 800);
        }

        /**
         * 切换暗黑模式
         * @param {Element} toggle - 切换按钮元素
         */
        function toggleDarkMode(toggle) {
            event.stopPropagation(); // 阻止事件冒泡
            
            toggle.classList.toggle('active');
            settingsData.darkMode = toggle.classList.contains('active');
            
            if (settingsData.darkMode) {
                showToast('暗黑模式已开启');
            } else {
                showToast('暗黑模式已关闭');
            }
            
            console.log('切换暗黑模式:', settingsData.darkMode);
        }

        /**
         * 切换通知
         * @param {Element} toggle - 切换按钮元素
         */
        function toggleNotifications(toggle) {
            event.stopPropagation();
            
            toggle.classList.toggle('active');
            settingsData.notifications = toggle.classList.contains('active');
            
            if (settingsData.notifications) {
                showToast('推送通知已开启');
            } else {
                showToast('推送通知已关闭');
            }
            
            console.log('切换推送通知:', settingsData.notifications);
        }

        /**
         * 切换声音效果
         * @param {Element} toggle - 切换按钮元素
         */
        function toggleSounds(toggle) {
            event.stopPropagation();
            
            toggle.classList.toggle('active');
            settingsData.sounds = toggle.classList.contains('active');
            
            if (settingsData.sounds) {
                showToast('声音效果已开启');
                if (navigator.vibrate) {
                    navigator.vibrate(50);
                }
            } else {
                showToast('声音效果已关闭');
            }
            
            console.log('切换声音效果:', settingsData.sounds);
        }

        /**
         * 切换触觉反馈
         * @param {Element} toggle - 切换按钮元素
         */
        function toggleHaptics(toggle) {
            event.stopPropagation();
            
            toggle.classList.toggle('active');
            settingsData.haptics = toggle.classList.contains('active');
            
            if (settingsData.haptics) {
                showToast('触觉反馈已开启');
                if (navigator.vibrate) {
                    navigator.vibrate(50);
                }
            } else {
                showToast('触觉反馈已关闭');
            }
            
            console.log('切换触觉反馈:', settingsData.haptics);
        }

        /**
         * 切换AI助手
         * @param {Element} toggle - 切换按钮元素
         */
        function toggleAIAssistant(toggle) {
            event.stopPropagation();
            
            toggle.classList.toggle('active');
            settingsData.aiAssistant = toggle.classList.contains('active');
            
            if (settingsData.aiAssistant) {
                showToast('AI写作助手已开启');
            } else {
                showToast('AI写作助手已关闭');
            }
            
            console.log('切换AI助手:', settingsData.aiAssistant);
        }

        /**
         * 切换自动保存
         * @param {Element} toggle - 切换按钮元素
         */
        function toggleAutoSave(toggle) {
            event.stopPropagation();
            
            toggle.classList.toggle('active');
            settingsData.autoSave = toggle.classList.contains('active');
            
            if (settingsData.autoSave) {
                showToast('自动保存已开启');
            } else {
                showToast('自动保存已关闭');
            }
            
            console.log('切换自动保存:', settingsData.autoSave);
        }

        /**
         * 切换字数统计
         * @param {Element} toggle - 切换按钮元素
         */
        function toggleWordCount(toggle) {
            event.stopPropagation();
            
            toggle.classList.toggle('active');
            settingsData.wordCount = toggle.classList.contains('active');
            
            if (settingsData.wordCount) {
                showToast('字数统计已开启');
            } else {
                showToast('字数统计已关闭');
            }
            
            console.log('切换字数统计:', settingsData.wordCount);
        }

        /**
         * 打开语言设置
         * @description 显示语言选择器
         */
        function openLanguage() {
            currentPickerType = 'language';
            pickerTitle.textContent = '选择语言';
            
            const languages = [
                { value: '简体中文', label: '简体中文' },
                { value: '繁體中文', label: '繁體中文' },
                { value: 'English', label: 'English' },
                { value: '日本語', label: '日本語' },
                { value: '한국어', label: '한국어' }
            ];
            
            showPicker(languages, settingsData.language);
            console.log('打开语言设置');
        }

        /**
         * 打开字体大小设置
         * @description 显示字体大小选择器
         */
        function openFontSize() {
            currentPickerType = 'fontSize';
            pickerTitle.textContent = '选择字体大小';
            
            const sizes = [
                { value: '较小', label: '较小' },
                { value: '标准', label: '标准' },
                { value: '较大', label: '较大' },
                { value: '特大', label: '特大' }
            ];
            
            showPicker(sizes, settingsData.fontSize);
            console.log('打开字体大小设置');
        }

        /**
         * 显示选择器
         * @param {Array} options - 选项列表
         * @param {string} current - 当前选中值
         */
        function showPicker(options, current) {
            pickerOptions.innerHTML = '';
            selectedOption = current;
            
            options.forEach(option => {
                const optionEl = document.createElement('div');
                optionEl.className = 'picker-option';
                optionEl.textContent = option.label;
                optionEl.dataset.value = option.value;
                
                if (option.value === current) {
                    optionEl.classList.add('selected');
                }
                
                optionEl.addEventListener('click', function() {
                    document.querySelectorAll('.picker-option').forEach(el => {
                        el.classList.remove('selected');
                    });
                    this.classList.add('selected');
                    selectedOption = this.dataset.value;
                });
                
                pickerOptions.appendChild(optionEl);
            });
            
            pickerModal.style.display = 'flex';
        }

        /**
         * 关闭选择器
         * @description 关闭选择器模态框
         */
        function closePicker() {
            pickerModal.style.display = 'none';
            currentPickerType = null;
            selectedOption = null;
        }

        /**
         * 确认选择器
         * @description 确认选择器的选择
         */
        function confirmPicker() {
            if (currentPickerType && selectedOption) {
                if (currentPickerType === 'language') {
                    settingsData.language = selectedOption;
                    document.querySelector('.setting-item .setting-value').textContent = selectedOption;
                    showToast(`语言已切换为${selectedOption}`);
                } else if (currentPickerType === 'fontSize') {
                    settingsData.fontSize = selectedOption;
                    const fontSizeItem = document.querySelectorAll('.setting-value')[1];
                    fontSizeItem.textContent = selectedOption;
                    showToast(`字体大小已调整为${selectedOption}`);
                }
                
                console.log('确认选择:', currentPickerType, selectedOption);
            }
            
            closePicker();
        }

        /**
         * 清理缓存
         * @description 清理应用缓存
         */
        function clearCache() {
            currentAction = 'clearCache';
            modalTitle.textContent = '清理缓存';
            modalMessage.textContent = '清理缓存将删除临时文件，但不会影响您的数据。确定要继续吗？';
            confirmBtn.textContent = '清理';
            confirmModal.style.display = 'flex';
            
            console.log('准备清理缓存');
        }

        /**
         * 重置应用
         * @description 重置应用到默认设置
         */
        function resetApp() {
            currentAction = 'resetApp';
            modalTitle.textContent = '重置应用';
            modalMessage.textContent = '这将恢复所有设置到默认状态，但不会删除您的账户数据。确定要继续吗？';
            confirmBtn.textContent = '重置';
            confirmBtn.className = 'modal-btn modal-btn-confirm';
            confirmModal.style.display = 'flex';
            
            console.log('准备重置应用');
        }

        /**
         * 删除账户
         * @description 删除用户账户
         */
        function deleteAccount() {
            currentAction = 'deleteAccount';
            modalTitle.textContent = '删除账户';
            modalMessage.textContent = '⚠️ 此操作不可逆！删除账户将永久删除您的所有数据，包括创作内容和个人信息。确定要继续吗？';
            confirmBtn.textContent = '删除';
            confirmBtn.style.background = '#FF453A';
            confirmModal.style.display = 'flex';
            
            console.log('准备删除账户');
        }

        /**
         * 确认操作
         * @description 执行确认的操作
         */
        function confirmAction() {
            if (currentAction === 'clearCache') {
                showToast('正在清理缓存...');
                setTimeout(() => {
                    showToast('缓存清理完成');
                    // 更新存储显示
                    const cacheFill = document.querySelectorAll('.storage-fill')[1];
                    cacheFill.style.width = '10%';
                    const cacheSize = document.querySelectorAll('.storage-size')[1];
                    cacheSize.textContent = '32 MB';
                }, 2000);
            } else if (currentAction === 'resetApp') {
                showToast('正在重置应用...');
                setTimeout(() => {
                    showToast('应用已重置到默认设置');
                    // 重置所有设置
                    Object.keys(settingsData).forEach(key => {
                        if (typeof settingsData[key] === 'boolean') {
                            settingsData[key] = true;
                        }
                    });
                    updateToggleStates();
                }, 2000);
            } else if (currentAction === 'deleteAccount') {
                showToast('正在删除账户...');
                setTimeout(() => {
                    showToast('账户已删除');
                    setTimeout(() => {
                        window.location.href = 'login.html';
                    }, 1500);
                }, 2000);
            }
            
            closeModal();
        }

        /**
         * 关闭模态框
         * @description 关闭确认模态框
         */
        function closeModal() {
            confirmModal.style.display = 'none';
            currentAction = null;
        }

        // 其他设置项处理函数
        function openPersonalInfo() {
            showToast('个人信息设置');
            console.log('打开个人信息设置');
        }

        function openSecurity() {
            showToast('安全与隐私设置');
            console.log('打开安全设置');
        }

        function openMembership() {
            showToast('会员与订阅管理');
            console.log('打开会员设置');
        }

        function openWordCount() {
            showToast('字数统计设置');
            console.log('打开字数统计设置');
        }

        function openHelp() {
            showToast('帮助中心');
            console.log('打开帮助中心');
        }

        function contactSupport() {
            showToast('联系客服');
            console.log('联系客服');
        }

        function sendFeedback() {
            showToast('意见反馈');
            console.log('发送反馈');
        }

        function rateApp() {
            showToast('感谢您的支持！');
            console.log('应用评分');
        }

        function openDeveloper() {
            showToast('开发者选项');
            console.log('打开开发者选项');
        }

        function exportData() {
            showToast('正在导出数据...');
            console.log('导出数据');
        }

        /**
         * 显示消息提示
         * @param {string} message - 提示消息
         */
        function showToast(message) {
            // 创建提示元素
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0, 0, 0, 0.8);
                color: #FFC542;
                padding: 12px 24px;
                border-radius: 24px;
                font-size: 14px;
                z-index: 3000;
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 197, 66, 0.3);
                animation: fadeInOut 2s ease;
            `;
            toast.textContent = message;
            
            // 添加动画样式
            const style = document.createElement('style');
            style.textContent = `
                @keyframes fadeInOut {
                    0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
                    20% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
                    80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
                    100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(toast);
            
            // 自动移除
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
                if (style.parentNode) {
                    style.remove();
                }
            }, 2000);
        }

        // 页面卸载时的清理工作
        window.addEventListener('beforeunload', function() {
            console.log('设置页面卸载');
        });

        // 页面可见性变化处理
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                // 页面重新可见时刷新设置数据
                loadSettings();
            }
        });
    </script>
</body>
</html> 